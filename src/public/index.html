<!DOCTYPE html>
<html>

<head>
    <title>v√©rnyomi</title>
</head>

<body>
    <button id="start-session" onclick="startSession()">start</button>
    <div id="session" style="display: none;">
        <h1>New Session</h1>
        <input type="text" id="session-comment" title="comment" placeholder="any comment?">
        <button id="save-session" onclick="saveSession()" title="continue to entering measurments">start</button>
    </div>
    <div id="measurements" style="display: none;">
        <h1>New Measurement</h1>
        <input type="number" id="sys" placeholder="Sys">
        <input type="number" id="dia" placeholder="Dia">
        <input type="number" id="puls" placeholder="puls">
        <input type="text" id="comment" placeholder="Comment">
        <button id="save-measurment" onclick="saveMeasurement()">next</button>
    </div>

    <script>
        function startSession() {
            document.getElementById('start-session').disabled = true;
            document.getElementById('session').style.display = 'block';
            document.getElementById('measurements').style.display = 'none';
        }
        function saveSession() {
            fetch('/start-session', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    comment: document.getElementById('session-comment').value
                })
            })
                .then(response => response.json())
                .then(data => {
                    console.log(data);
                    document.getElementById('session').style.display = 'none';
                    document.getElementById('measurements').style.display = 'block';
                    localStorage.setItem('sessionId', data.sessionId);
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        }
        function saveMeasurement() {
            fetch('/save-measurement', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    sessionId: localStorage.getItem('sessionId'),
                    sys: document.getElementById('sys').value,
                    dia: document.getElementById('dia').value,
                    puls: document.getElementById('puls').value,
                    comment: document.getElementById('comment').value
                })
            })
                .then(response => response.json())
                .then(data => {
                    console.log(data);
                    document.getElementById('sys').value = '';
                    document.getElementById('dia').value = '';
                    document.getElementById('puls').value = '';
                    document.getElementById('comment').value = '';
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        }
    </script>
</body>

</html>